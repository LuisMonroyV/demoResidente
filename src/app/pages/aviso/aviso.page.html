<app-header titulo="Aviso de Visitas"></app-header>

<ion-content>
  <div id="container">
    <form (ngSubmit)="guardarAviso()"
          novalidate="novalidate"
          #formAviso="ngForm">
      <ion-card>
        <ion-list>
          <ion-item lines="none">
            <ion-icon color="primary" name="calendar-outline" slot="start"></ion-icon>
            <ion-label>Fecha:</ion-label>
            <ion-datetime displayFormat="DD MMM YYYY" 
                          pickerFormat="DD MMM YYYY"
                          cancelText="Cancelar"
                          doneText="OK"
                          mode="ios"
                          [min]="fbSrvc.fechaHoyIso"
                          monthShortNames="Ene, Feb, Mar, Abr, May, Jun, Jul, Ago, Sep, Oct, Nov, Dic"
                          name="fechaAviso"
                          [(ngModel)]="fechaString"
                          required
                          >
            </ion-datetime>
          </ion-item>
          <ion-item lines="none">
            <ion-icon name="chatbubble-outline" slot="start" color="primary"></ion-icon>
            <ion-label>Nombre: </ion-label>
            <ion-input type="text"
                      name="nota"
                      [(ngModel)]="nuevoAviso.nota" 
                      mode="ios"
                      #notaInput
                      required
                      style="padding-left: 10px;"
                      class="ion-padding"
                      >
            </ion-input>
          </ion-item>
          <ion-item lines="none">
            <ion-icon name="phone-portrait-outline" slot="start" color="primary"></ion-icon>
            <ion-label>Llamarme cuando llegue</ion-label>
            <ion-toggle color="primary"
                        name="avisar"
                        [(ngModel)]="nuevoAviso.avisar"
                        >
            </ion-toggle>
          </ion-item>
        </ion-list>  
        <ion-button type="submit"
                    expand="block" 
                    [disabled]="!formAviso.valid || guardando"
                    >
          Guardar Cambios
        </ion-button>
        <ion-ripple-effect type="bounded"></ion-ripple-effect>
      </ion-card>
    </form>
    <ion-card>
      <ion-card-title class="ion-text-center ion-padding">
        Mis avisos para hoy
      </ion-card-title>
      <ion-list>
        <ion-item lines="none"
                  *ngFor="let item of misAvisos; let i=index">
          <ion-label text-wrap>
            {{i+1}}.- {{item.nota}} 
            <ion-icon name="notifications-outline"
                      *ngIf="item.avisar"
                      color="primary"
                      >
            </ion-icon>
            <ion-icon name="notifications-off-outline"
                      *ngIf="!item.avisar"
                      >
            </ion-icon>
          </ion-label>
          <ion-icon name="close-circle-outline"
                    color="danger"
                    (click)="borrarAviso(i)"
                    size="large"
                    slot="end"
                    >
          </ion-icon>
        </ion-item>
      </ion-list>
      <div *ngIf="misAvisos.length === 0"
           class="ion-text-center">
        <img src="assets/images/no-data-8.png" width="40%"/>
      </div>
    </ion-card>
    
    <ion-card>
      <ion-card-title class="ion-text-center ion-padding">
        Mis avisos programados
      </ion-card-title>
      <ion-list>
        <ion-item lines="none"
                  *ngFor="let item of misAvisosProgramados; let i=index">
          <ion-label text-wrap>
            {{i+1}}.- ({{ item.fecha | fechaCorta: 'DD-MMM-YY' : ''}}) {{item.nota}} 
            <ion-icon name="notifications-outline"
                      *ngIf="item.avisar"
                      color="primary"
                      >
            </ion-icon>
            <ion-icon name="notifications-off-outline"
                      *ngIf="!item.avisar"
                      >
            </ion-icon>
          </ion-label>
          <ion-icon name="close-circle-outline"
                    color="danger"
                    (click)="borrarAvisoProgramado(i)"
                    size="large"
                    slot="end"
                    >
          </ion-icon>
        </ion-item>
      </ion-list>
      <div *ngIf="misAvisosProgramados.length === 0"
           class="ion-text-center">
        <img src="assets/images/no-data-8.png" width="40%"/>
      </div>
    </ion-card>
  </div>
</ion-content>
